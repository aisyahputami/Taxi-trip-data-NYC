# Taxi trip data NYC

## About Dataset

### NYC Cabs
If you live in a mid-to-large-sized city and take taxis, you have probably already tried Uber. What you may not know is that the transportation app has different rates in each city. New York City is arguably the taxi capital of America and home to the classic yellow taxicab.

They do have some similarities—both conventional taxis and Uber charge fares based on a combination of time and distance. Both also charge passengers for any bridge or road tolls in addition to the fare. However, there are also significant differences between Uber and taxis in New York City. Which is the quickest and most economical ride in New York City, and what are the differences between Uber and Yellow Cab?

### Key Takeaways
Both conventional taxis and Uber charge fares based on a combination of time and distance.
Taxis do not have surge pricing, but riders might have to wait longer when demand exceeds supply.
Uber does not differentiate between cruising and stop-and-go traffic, while taxis do charge different rates based on speed.

Uber does not differentiate between cruising and stop-and-go traffic, while taxis do charge different rates based on speed. In addition, Uber has price hikes during times of high demand, while taxis have extra rush hour fees. Uber does provide fare estimates within the Uber app, but it does not guarantee the final fare because road conditions can change during the ride.

The service is only accessible through an up-to-date smartphone. If you do not own a smartphone, your smartphone is not up to date, or you forgot your phone, you will not be able to use Uber. New York City regulations prohibit street hails for private ride services (also called livery services).

### Yellow Cabs
Getting into a taxi in an unfamiliar city can be nerve-wracking. You have no idea how much the trip should cost or if the driver is taking the most direct route. In New York City, taxi riders cannot get an advance estimate for taxi fares. The NYC Taxi and Limousine Commission’s official stance is that “it is impossible to pre-calculate a fare because the meter rate depends on traffic, construction, weather, and route to the destination.”

Yellow cabs accept street hails anywhere in New York City. Green Boro Taxis, which operate in the outer boroughs and parts of Manhattan north of certain streets, can either be prearranged or hailed on the street.

### Uber Cabs
Uber has something called surge pricing, which refers to the higher fares it imposes during times of high rider demand. Surge pricing can take effect during rush hour, during a natural disaster, or during a random spike of requests on a Saturday afternoon. Uber claims these price increases are meant to encourage more Uber drivers to get out on the road, and that prices revert to normal when supply and demand even out—capitalism at its finest. The Uber app notifies users of surge pricing when they request a ride.

Uber used to offer a $60 flat rate between Manhattan and JFK but dropped that option. Rates are now calculated based on time and distance.

Taxis do not have surge pricing, but riders might have to wait longer when demand exceeds supply. Taxis do, however, add a $0.50 surcharge in the evening (8:00 p.m. to 6:00 a.m.) and a $1 surcharge during rush hour (4:00 p.m. to 8:00 p.m.), Monday through Friday. If Uber’s surge pricing is in effect, you will probably pay a lot less by taking a cab, if you can get one. Surge pricing will at least double your usual fare, and Uber has reported charging customers as much as $39 per mile. A New York City councilman introduced a bill in January 2015 proposing to limit surge pricing to twice the usual rate.

Yellow cabs have regulated fares to and from the Newark International and John F. Kennedy International airports. For trips between Newark International Airport and New York City, the price is the regular metered fare, plus a $17.50 surcharge, plus tolls. For trips between John F. Kennedy International Airport and Manhattan, it is a flat fare of $52 plus tolls. The regular metered fare applies to all trips to and from LaGuardia International Airport.

### Payments and Tipping
Before you can call an Uber, you must download the app onto your smartphone and register a credit card or PayPal account to your Uber account. Uber automatically charges your account at the end of the ride. When you take a cab, you can pay with cash, credit card, or a payment app on your phone, like Apple Pay.

Tipping is different with each service, too. Uber allows riders to tip their driver through the app after they have rated their ride, once complete. You have 30 days to add a tip once your ride is complete.

NYC cab drivers are required to accept MasterCard, Visa, Discover, and American Express credit cards and MasterCard and Visa debit cards with no minimum fare requirement. Passengers pay for rides by swiping their card through a card reader and can see the transaction details on a monitor in the back seat. Passengers must sign for card transactions over $25. Uber's receipts are emailed to the passenger and available through the app.

Tipping is customary for cab rides. You can add the tip to your credit card or pay it in cash. Most riders who pay by credit card tip 20%, which might have something to do with the automatic tip options offered by the credit card machine: 20%, 25%, and 30%. You can always calculate your own tip or decline to tip altogether for bad service.

### Vehicle Types
Uber’s vehicles range from standard consumer cars like Honda Accords in the uberX class to upscale vehicles like all-black Cadillac Escalades under UberSUV. Uber policy is that all cars must be no more than 15 years old and must be easy to enter and exit and four-door (so no pickup trucks or compact cars).

Taxicabs hold either four or five passengers, depending on the vehicle model. The most common vehicle model for older taxis is the Ford Crown Victoria. There is an approved vehicle list for taxicabs. All taxis are painted yellow, except for taxis in boroughs other than Manhattan, which are green. If you want a fancier ride, you will need to call a traditional private car service or use Uber.

### Customer Service
Since passengers request all Uber rides through the app, there is no waiting on the street and getting drenched trying to hail a ride in bad weather. Nor will you find yourself standing alone on an empty street late at night trying to catch a cab. The app lets users know when the driver has arrived, so passengers can wait indoors.

Uber actively seeks and reviews passenger feedback on drivers. After each ride, Uber asks the passenger to rate the driver through the app and add comments. Uber will stop using a driver who gets too many low ratings. Uber drivers also rate passengers, and passengers have to contact Uber or ask a driver to find out their scores. Some drivers avoid passengers with low scores. Uber may temporarily ban passengers for inappropriate or unsafe behaviour and permanently refuse service to riders who have been aggressive, violent, or disrespectful.

What if you have a bad experience during your ride? The NYC Taxi and Limousine Commission posts a passenger bill of rights inside the cab that drivers and cab owners must adhere to. If you want to make a complaint, the NYC TLC directs passengers to call 311 or make the complaint online through this form.

To file a complaint about a bad taxi ride, the passenger should first get a receipt from the driver that shows the taxi’s unique four-character medallion number. You can also get the medallion number from the taxi’s license plate, roof, or inside the car on the back of the partition. You can then file a complaint online through the NYC Taxi and Limousine Commission website. If the driver pleads guilty, they will pay a fine and the case will be closed. If the driver pleads not guilty, there will be a hearing that requires you to give testimony by phone or in person.

What if you leave something in a cab? Again, you need the medallion number to report to the NYC Taxi and Limousine Commission for help tracking down your belongings. If you leave something in an Uber, you can open the Uber app and click on a link to your electronic receipt for the ride to find and contact the driver.

### Uber vs. Yellow Cabs Example
It can be difficult to understand how these pricing structures work in real life, so here is an example of how it works with Uber. For a 5-mile, 10-minute trip going 25 miles per hour the entire way, uberX would cost $2.55 base fare plus $3.50 for the 10 minutes plus $10.75 for the mileage, for a total of $16.80. You can now add a tip on Uber if you choose.

But what about yellow cabs? The same 5-mile, 10-minute trip going 25 miles per hour, the entire way in a taxi would cost the base fare of $2.50 plus 25 units at $0.50 each, or $12.50, for a total of $15.00. It is customary to tip the driver 10% to 20%. This adds $3 to the cab fare, for a total of $18.

In this example, the cost of each ride is close. Which option is cheaper in other scenarios depends on traffic. When Sara Silverstein did the math for Business Insider, she found that taxis are cheaper in New York City when traffic is flowing at under 20 MPH. Uber is cheaper in other cases unless it is charging high-demand fares.

## Load and Transform Raw data
### Data Ingestion from CSV to BigQuery
First, let's create a virtual environment in the project folder.
![venv](https://github.com/aisyahputami/Taxi-trip-data-NYC/blob/main/bigquery/create-venv.png)

Then, let's create a dataset. We'll name the dataset 'weekly'.
![dataset](https://github.com/aisyahputami/Taxi-trip-data-NYC/blob/main/bigquery/create-weekly-dataset.png)

Next, activate the venv and run `dbt init`. The goal is to ensure that the dependencies and Python packages needed by our dbt project are well isolated from the global Python environment, while `dbt init` sets up the basic structure of the required project. Name our project 'taxi'.

![dbt-init](https://github.com/aisyahputami/Taxi-trip-data-NYC/blob/main/bigquery/activate-vevn-dbt-init.png)

We select BigQuery as the database to be used. Also, choose [2] service_account as the authentication method, input the GCP project ID, dataset, threads, and location. Then, enter the 'taxi' project folder, run 'dbt debug', and make sure all checks have passed.

![dbt-debug](https://github.com/aisyahputami/Taxi-trip-data-NYC/blob/main/bigquery/dbt-debug-weekly.png)

Move the CSV dataset file into the taxi\seeds folder. Then, run 'dbt seed'. The function of 'dbt seed' is to load initial data or seed data into a database table. Make sure that in the BigQuery dataset 'weekly_assignment', the table 'taxi' already exists.

![dbt-seed](https://github.com/aisyahputami/Taxi-trip-data-NYC/blob/main/bigquery/dbt-seed-weekly.png)

![taxi-table](https://github.com/aisyahputami/Taxi-trip-data-NYC/blob/main/bigquery/taxi-table.png)

### Create dbt Models
#### Monthly Total Passengers
![passengers]()
From the table, we can observe data representing the monthly passenger count from 2008 to 2021. Here are some insights that can be derived:

1. **Passengers per Month**: The table illustrates the monthly count of passengers from 2008 to 2021. It shows that the number of passengers varies from month to month and from year to year.
2. **Growth Trends**: The data indicates growth trends in passenger numbers from 2008 to 2021. It's noticeable that the number of passengers tends to increase over the years, with the highest surge occurring in July 2021.
3. **Upward Trend**: Despite normal monthly fluctuations, there's a general upward trend in passenger numbers over time. The significant increase in July 2021 might be attributed to seasonal factors or specific events affecting transportation demand.
4. **Potential for Further Analysis**: This data can be used for further analysis, such as identifying factors influencing passenger demand, predicting future trends, and developing more effective marketing or operational strategies to optimize fleet utilization.

#### Monthly Transactions per Payment Type
![transactions]()
From the provided table, we can derive the following insights:

1. **Payment Type Distribution**: The data showcases the distribution of payment types utilized for taxi trips over different months and years. The predominant payment types are Cash and Credit Card, with occasional occurrences of Dispute, No Charge, and Unknown.
2. **Variability in Transaction Amounts**: The monthly transaction amounts vary significantly across payment types and time periods. For instance, in July 2021, the transaction amounts for Cash and Credit Card payments are substantially higher compared to other months, indicating a potential surge in taxi usage during that period.
3. **Prevalence of Electronic Payments**: Credit Card payments appear to be more prevalent in recent years, as indicated by the higher transaction amounts compared to Cash payments in 2021. This trend may suggest a shift towards electronic payment methods among taxi passengers.
4. **Anomalies**: There are instances of Dispute, No Charge, and Unknown payment types, which may represent exceptional cases or errors in the payment processing system. Further investigation may be required to understand the nature of these transactions and their impact on overall revenue and operations.
5. **Seasonal Variations**: The data reflects seasonal variations in taxi transactions, with higher transaction amounts observed during certain months (e.g., July 2021). These fluctuations could be influenced by factors such as tourism, events, or changes in consumer behavior.
Overall, this data provides valuable insights into the payment behavior of taxi passengers over time, highlighting trends, anomalies, and potential areas for further analysis and optimization.

#### Monthly Trip Distance per Rate Code
![distance]()
Based on the provided data, the following insights can be derived:

1. Variation in Trip Types: The data reveals different types of trip rates, including Standard Rate, Negotiated Fare, JFK, Nassau or Westchester, and Newark. Each rate code corresponds to specific trip categories, such as standard city trips, negotiated fares, trips to airports (JFK and Newark), and trips to nearby counties (Nassau or Westchester).
2. Trip Distance Distribution: The monthly trip distance varies across different rate codes and time periods. For instance, in July 2021, trips under the Standard Rate exhibit significantly higher distances compared to other rate codes, indicating a higher frequency of longer trips during that month.
3. Seasonal Trends: There are fluctuations in trip distances over time, with variations observed across different months and years. For example, in June 2021, the trip distance for Negotiated Fare is recorded as 0.0, suggesting a potential anomaly or a change in trip patterns during that period.
4. Airport Trips: Trips to airports (JFK and Newark) tend to have longer distances compared to standard city trips, as evidenced by the higher trip distances recorded for these rate codes. This could be attributed to the distance between city locations and airport terminals.
5. Operational Insights: The data provides insights into the operational aspects of taxi services, such as the distribution of trip types, the variability in trip distances, and the impact of factors like negotiated fares on overall trip metrics. Understanding these patterns can help optimize service operations, route planning, and resource allocation.

### Extra per Trip Type
"Miscellaneous extras and surcharges" refers to additional fees that may be applied on top of the base fare in a transaction or payment. In this context, it specifically mentions the $0.50 and $1 charges for rush hour and overnight services.

![extra]()
Here are some insights from the data above:

1. Monthly additional charges imposed by VeriFone Inc and Creative Mobile Technologies, LLC vary from month to month, with the highest peak occurring in July 2021.
2. The majority of trips do not use the Store and Forward Trip method, except in July 2021, where Creative Mobile Technologies, LLC has some trips using this method.
3. The trend of additional charges seems to increase from year to year, especially in July 2021.
4. Additional charges imposed by VeriFone Inc tend to be more varied compared to Creative Mobile Technologies, LLC.
5. In August 2021, the amount of additional charges imposed by VeriFone Inc is lower compared to previous months.

### Congestion Surcharge per Rate Code
![surcharge]()
Here are some insights derived from the table:

1. The "Standard Rate" has the highest congestion surcharge compared to other rate codes, indicating that trips under this rate are subject to significant congestion fees.
2. Trips to or from JFK airport have a moderate congestion surcharge, suggesting that travel to and from airports may incur additional charges due to congestion.
3. The "Negotiated Fare" rate code has a notably high congestion surcharge, indicating that negotiated fares may include surcharges for congestion.
4. The absence of a congestion surcharge for trips to Newark suggests that this area may not experience significant congestion-related costs.
5. The "Nassau or Westchester" rate code has a lower congestion surcharge compared to the "Standard Rate," indicating that trips to these areas may involve less congestion or shorter distances.
6. 
These insights provide valuable information about the distribution of congestion surcharges across different rate codes, helping to understand the cost implications of taxi trips in various locations and under different fare structures.









